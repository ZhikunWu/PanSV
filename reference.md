
### A telomere-to-telomere genome assembly of Zhonghuang 13, a widely-grown soybean variety from the original center of Glycine max


### The genome of a wild Medicago species provides insights into the tolerant mechanisms of legume forage to environmental stress

De novo predictions, homolog-based, and RNA-seq-based predictions were employed to annotate the protein-coding genes. Five ab initio gene prediction programs were used to predict genes, including Augustus v3.0.2, Genescan v1.0, Geneid, GlimmerHMM v3.0.2, and SNAP. Protein sequences of ten homologous species A. thaliana, M. truncatula, G. max, T. pratense, C. arietinum, Vigna angularis, V. radiate, C. cajan, P. vulgaris, and Arachis ipaensis were downloaded from the Ensembl or NCBI. Homologous sequences were aligned against to the repeat-masked M. ruthenica genome using TblastN (e value ≤1e−5). Genewise v2.2.0 was employed to predict gene models based on the alignment sequences [49]. There were two ways to assemble the RNA-seq data into the unique sequences of transcripts. One was mapping the RNA-seq data to the M. ruthenica genome using Tophat v2.0.8 [50] and Cufflinks v2.1.1 [51] for transcript assembly. The other was applying Trinity [52] to assemble the RNA-seq data, and then PASA software [53] improved the gene structures. A weighted and non-redundant gene set was generated by EVidenceModeler [54] which merged all genes models predicted by the above three approaches. PASA adjusted the gene models generated by EVM. Lastly, the gene sets were filtered according to the following standards: coding region lengths of amino acids ≤50, supported only by de novo methods and with FPKM<5.


Functional annotation of protein-coding genes was obtained according to best Blast hit by BlastP (e value ≤1e−5) against SwissProt [55] and NCBI non-redundant (NR) protein databases. Motifs and domains were annotated by using InterProScan v4.7 [56] to search against InterPro v29.0 databases [56], including Pfam, Prints, Prosite, ProDom, and Smart. The tRNA genes were predicted by tRNAscan-SE software [57]. The miRNA and snRNA fragments were identified by INFERNAL software [58]against the Rfam database [59]. The rRNAs were found by using BlastN (e value ≤1e−10) against invertebrate rRNA database. The structure figure was drawn along eight chromosomes of M. ruthenica genome using Circos program [60]. To estimate the assembly of genome, transcriptome data. from roots, stems, leaves, flowers, and pods were mapped to the genome assembly using Hisat2 [61], and transcripts were assembled using Trinity [52]. The unigene, which was the longest transcript selected from Trinity, was aligned to the genome assembly by Blat [62].





### Chromosome-scale assembly of the African yam bean genome
Gene prediction and functional annotation of genome We combined transcript and homology evidence to annotate the gene content of the AYB genome. The transcript evidence was generated from 17,117,377 ONT longread RNA reads totalling 7.1 Gbp of sequencing data used for de novo assembly of 60,249 transcripts. Briefly, Minimap239 (v2.22) was used to index the AYB genome assembly and the RNA reads were mapped to the indexed assembly. Samtools16 (v1.9) was used to sort mapped reads by coordinates that were used to assemble transcripts with Stringtie240 (v2.0.1). Transdecoder41 (v2.0.1) was then used to identify candidate CDS regions and select transcripts with a minimum protein length of 100 amino acids.
We combined the de novo transcripts with protein homology evidence from four wellannotated plant genomes (Arabidopsis thaliana TAIR10, Phaseolus vulgaris v1.0, Glycine max v2.1, Vigna_angularis v1.1) together with a soft-masked (for repeats) AYB genome as inputs into Funannotate42 (v1.8.11) to identify protein coding genes. Funannotate ‘predict’ uses ab initio gene predictors Augustus43, PASA44, SNAP45 and GlimmerHMM46 together with protein sequences as evidence to predict genes. Gene predictions from all four ab initio predictors are passed to EVidenceModeler47 with various weights for integration. This resulted in 30,840 coding gene models totalling 31,614 transcripts with a median exon length of 231 bp and a median of three exons per transcript. Additionally, we detected 774 non-overlapping tRNAencoding
genes using tRNAscan-SE48 for tRNA prediction. The gene and
transposable element distribution across the genome are inversely correlated (Fig. 5).
Protein domains were annotated using InterProScan-5.25-64.049 based on InterPro protein databases, including TIGRFAM, SUPERFAMILY, PANTHER, Pfam, PRINTS and ProDom. We also used eggNOG-mapper50 (v2.1.7) to annotate predicted gene models. Funannotate ‘annotate’ uses results of InterProScan and eggNOG-mapper to annotate putative functions of protein sequences using PFAM51, UniProtKB52 and Gene Ontologies53 databases. In total, 25,241 (81.85%) of the genes.

Gene family analysis To delineate gene families, AYB was compared to other legumes L. purpureus, P. vulgaris, Vigna unguiculata, and Mycrotyloma uniflorum (with Solanum tuberosum as an outgroup) using OrthoFinder54 (v2.5.4). This analysis placed 26,038 (84.4%) of the 30,840 AYB proteins into orthogroups. Clustering using Venn Diagrams55 revealed 1,296 AYB proteins (4.2%) segregated in 384 species-specific orthogroups (Fig. 7).


### Chromosome-level genome assembly of bean flower thrips Megalurothrips usitatus
Gene and functional predictions. 
Genes in the assembled genome were predicted using a combination of homology-based, transcriptome-based, and ab initio methods. Homology-based predictions involved downloaded sequences of peptides and transcripts from Aptinothrips rufus (http://v2.insect-genome.com/ Organism/87), Frankliniella occidentalis (https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/697/945/ GCF_000697945.3_Focc_3.1), and Thrips palmi (https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/012/932/325/ GCF_012932325.1_TpBJ-2018v1). The IsoSeq version 3.4.0 workflow was utilized to generate 28,608 high-quality transcripts from the full-length transcriptome data, with quality parameters of 0.99 (https://github.com/ PacificBiosciences/IsoSeq). Next, RNA-seq short data were mapped to the reference genome using HISAT2 version 2.2.134 with the parameter ‘-k 2’. The mapped reads were then assembled into transcripts using StringTie version 2.4.035 with default parameters. Homologous proteins and transcripts were aligned using Exonerate version 2.4.0 with default parameters to train the gene sets. Meanwhile, a sorted and mapped bam file of RNA-seq data was transferred to a hints file using the bam2hints program in AUGUSTUS version 3.2.336 with the parameter ‘–intronsonly’. The trained gene sets and hint files were combined as inputs for AUGUSTUS version 3.2.336, which predicted coding genes from the assembled genome with default parameters. Finally, homology-based, de novo-derived, and transcript genes were merged in MAKER version 2.31.10 to generate a high-confidence gene set37. It resulted in the annotation of 14,000 M. usitatus genes. The average transcript length was 2,243.30 bp with an average length of coding sequence (CDS) of 1,588.94 bp. The average exon number per gene was 7.38, and the average exon length was 303.85 bp (Table 4).




## Genome assemblies of Vigna reflexo-pilosa (créole bean) and its progenitors, Vigna hirtella and Vigna trinervia , revealed homoeolog expression bias and expression-level dominance in the allotetraploid

To identify re petiti ve element families in the genome assembly, RepeatModeler version 2.0.3 ( http://www.repeatmasker.org/Rep eatModeler/) was used to construct a de novo r epeat libr ary [ 33 ]. This pipeline emplo y ed 2 distinct repeat discovery algorithms, RECON (version 1.08) and RepeatScout (version 1.0.6), to identify the boundaries of re petiti ve elements and build consensus models of interspersed repeats [ 34 , 35 ]. We aligned repeat sequences in the library to GenBank’s nr protein database using BLASTX (e-value cutoff = 10 −6 ) to ensure that they did not contain large families of protein-coding sequences.
To identify protein-coding sequences in the unmasked assembly, we used EvidenceModeler (EVM) version 1.1.1 to combine evidence from RNA-based prediction, homology-based prediction, and ab initio prediction [ 36 ]. For RNA-based prediction, we used e vidence fr om P acBio Iso-seq data obtained fr om leaf, stem, and flo w er tissues. Full-length transcripts were mapped to the final assembly using the genomic mapping and alignment pr ogr am (GMAP) version 2020–09-12 [ 37 ]. Protein sequences from Glycine max , Phaseolus vulgaris , Vigna unguiculata , Vigna angularis , Vigna mungo , and Arabidopsis thaliana available on the public databases were aligned to the unmasked genome using analysis and annotation tool (AAT) [ 38 ]. Protein-coding gene predictions were obtained with Augustus version 3.2.1 [ 39 ] trained with G. max , P. vulgaris , V. unguiculata , V. angularis , V. mungo , V. reflexo-pilosa , and A. thaliana PASA transcriptome alignment assembly using V. reflexopilosa alignment files as inputs. All gene pr edictions wer e integrated by EVM to generate consensus gene models using the follo wing w eights for eac h e vidence type: PASA2–1, GMAP–0.5, AAT–0.3, and Augustus–0.3. Any predicted genes that had more than 20% ov erla pping sequence with r e petiti ve sequences or had no RNA-seq support were excluded from the list of annotated genes.



## Genome assemblies of Vigna reflexo-pilosa (créole bean) and its progenitors, Vigna hirtella and Vigna trinervia , revealed homoeolog expression bias and expression-level dominance in the allotetraploid
### Phylogenetic analyses and comparati v e genomics 
OrthoFinder version 2.4.0 [ 40 ] was used to identify orthologous groups in A. thaliana , Citrullus lanatus , Cucumis melo , Cucumis sativus , G. max , Oryza sativa , P. vulgaris , V. hirtella , V. mungo , Vigna radiata , V. reflexo-pilosa , V. trinervia , and V. unguiculata . We constructed a phylogenetic tree based on protein sequences from single-copy orthologous groups using RAxML-NG pr ogr am v ersion 1.0.2 [ 41 ]. We first aligned protein sequences in each single-copy orthologous group with MUSCLE version 3.8.1551 [ 42 ] and r emov ed alignment gaps with trimAI version 1.4 rev15 [ 43 ] using the automated1 heuristic method. We subsequently concatenated alignment blocks using the catsequences pr ogr am ( https: //github.com/Chr isCr eevey/catsequences ), and the substitution model for each block was estimated using the ModelTest-NG progr am v ersion 0.1.7 [ 44 ]. The outputs wer e used to compute a maximum likelihood phylogenetic tree. Divergence times were estimated using the MCMCtree software version 4.0 (PAML 4 package) [ 45 ] using the r elaxed-cloc k model with the known div er gence time between C. melo and C. sativus , which was estimated at 8.4 to 11.8 million years ago (MYA) [ 46 ].

### Genome synteny analysis 
MCscanX [ 47 ] was used to analyze the colinearity within the V. reflexo-pilosa genome and between V. reflexo-pilosa–G. max , V. reflexo-pilosa–P. vulgaris , V. reflexo-pilosa–V. hirtella , V. reflexo-pilosa– V . mungo , V . reflexo-pilosa–V . radiata , V . reflexo-pilosa–V . trinervia , and V . reflexo-pilosa–V . unguiculata genomes. V . reflexo-pilosa amino acid sequences were aligned against themselves , G . max , P. vulgaris , V . hirtella , V . mungo , V . radiata , V . trinervia , or V . unguiculata using BLASTP (with an e-value cutoff of 10 −10 ) in order to identify putativ e par alogs. Intr a genic homeologous bloc ks wer e defined as regions of ten or more genes with colinear or nearly colinear runs of paralogs elsewhere in the genome with fewer than six intervening genes . T hese intragenic homeologous blocks were visualized using CIRCOS version 0.69.8 [ 48 ]. Similarly, we also performed pairwise comparisons of input protein sequences from V . reflexo-pilosa , V . mungo , and V . radiata . Clustering was carried out using OrthoMCL software version 2.0.9 [ 49 ] based on a Markov clustering algorithm. Syntenic blocks between V. reflexo-pilosa , V. mungo , and V. radiata were identified by MCscanX and plotted with CIRCOS using the criteria mentioned above (at least ten colinear genes and fewer than six intervening genes allo w ed).


### Transposable element annotation 

RepeatModeler (v2.0.1)63
library with default parameters. LTR_Finder (v1.07)64 parameters and LTR_harvest (v1.6.1)65
was used to construct a nonredundant TE with default
with parameters ‘-similar 30 -seed
20 -minlenltr 100 -maxlenltr 3500 -motif TGCA’ were used to construct LTR-RT libraries. LTR_retriever (v2.9.0)66
of LTR_Finder and LTR_harvest and to generate a nonredundant LTR-RT library. Thereafter, we combined the LTR-RT library and the TE library, the redundancy of which was removed using CD-HIT (v4.8.1)67
with
parameters ‘-c 0.8 -aS 0.8’. Finally, genome-wide repetitive sequences were annotated and classified based on the constructed library using RepeatMasker (v4.1.0; http://repeatmasker.org) with default parameters. Full-length LTR-RTs identified by LTR_retriever were clustered by CD-HIT (v4.8.1) with parameters ‘-c 0.9 -aS 0.9’. The insertion time of the intact LTR-RT was calculated using the base substitution rate of 1.3 × 10−8
per site per year.


### Gene prediction and functional annotation 

Protein-coding gene models were predicted based on repeat-masked assemblies using a strategy that combined homology-based, transcripts-based and ab initio predictions. For homology-based gene prediction, exonerate (https://github.com/nathanweeks/exonerate) was used to detect homologous gene models with default parameters. For transcripts-based prediction, Trinity (v2.8.5)68
was used to assemble
mRNA-seq reads into transcripts, which were subsequently subject to PASA (v2.4.1)69
for gene model prediction. For ab initio prediction,
AUGUSTUS (v3.2.3; https://github.com/Gaius-Augustus/Augustus) and GeneMark (v4.69_lic)70
were used to predict gene structures, incorporating transcriptome data as evidence. Finally, EVidenceModeler (v1.1.1)71
was used to merge gene predictions from the three approaches
and generate a weighted consensus gene set for each genome assembly. Predicted gene models were checked to ensure the correct placement of start and stop codons. Genes containing internal stop codons or
lacking the start/stop codons were removed. BUSCO was used to evaluate the completeness of gene annotation. InterProScan (v5.46-81.0)72 was then used to predict motifs and functional domains. Gene ontology (GO) information was extracted from the output of InterProScan. GO enrichment analysis was performed by ClusterProfiler (v4.0.5)73



### Phylogenetic analysis 

For the 704 resequencing accessions, a total of 6,704,072 filtered SNPs were used for phylogenetic analysis by FastTree (v2.1.11) with default parameters. The online tool iTOL (http://itol.embl.de) was used to visualize the constructed tree. We also constructed a phylogenetic tree, including the 27 de novo assembled B. oleracea genomes and the Arabidopsis genome (outgroup). Single-copy genes between these 28 genomes were determined by OrthoFinder (v2.4.0)26
with default
parameters. The coding sequences of the single-copy gene families were aligned using MUSCLE (v3.8.1551)74
. Gblock (v0.91b)75
The phylogenetic tree was constructed using FastTree77 parameters and visualized using iTOL.
was used
to extract the conserved sequences among the 28 genomes. Seqkit (v2.1.0)76
was used to concatenate sequences for phylogenetic analysis.



### Analysis of tandem repeat clusters 
We used StainedGlass v0.4 (https://github.com/mrvollger/StainedGlass) to identify repeat sequence clusters. The genomic distribution of repeat sequences was visualized using HiGlass v0.10.1 (https://github. com/higlass/higlass) and HiGlass Manage (https://github.com/higlass/ higlass-manage) with the gene annotation track (https://github.com/ higlass/gene_annotations).


### Transcriptome assembly for gene modelling 
The transcriptome assembly was performed using a combination of genome-guided and de novo approaches. The genome-guided approach used StringTie v2.1.4 (https://github.com/gpertea/stringtie) with aligned reads from HiSat2 v2.1.0 (https://github.com/DaehwanKimLab/hisat2). For the de novo approach, we first ran Trinity v2.8.5 with default parameters, followed by running TransAbyss v2.0.1 (https://github.com/bcgsc/transabyss) for multiple k-mers (51, 61, 71, 81, 91 and 101). The resulting files from both approaches were merged to generate a single high-confidence transcriptome assembly using EvidentialGene v2022.01.20 (https://sourceforge.net/projects/evidentialgene/). This approach was repeated for six RNA-seq libraries (DRR461683–DRR461688).


### Gene model prediction 
Gene model prediction was performed using a combination of ab initio and homology-based approaches. First, six transcriptome assemblies were splice-aligned against the genome using PASA v2.3.3 (https://github.com/PASApipeline/PASApipeline). The longest ORFs from these PASA alignments were also extracted using TransDecoder v.5.5.0. Next, we used the ab initio gene prediction tool GeneMark-ES v4.65 (ref. 98) and Braker v2.1.2 (https://github.com/Gaius-Augustus/ BRAKER) to produce two separate sets of candidate gene models on the reference genome soft-masked by RepeatMasker as described above. The initial RNA-seq alignments for Braker were produced using STAR aligner v2.7.2b (https://github.com/alexdobin/STAR). The final prediction step in Braker was carried out using Augustus v3.3.2 (https://github.com/Gaius-Augustus/Augustus). Braker was run for six RNA-seq libraries. The homology-based predictor GeMoMa v1.6.1 (ref. 99) was used to produce two additional sets of candidate gene models using gene models from Arabidopsis thaliana (Athaliana_167_TAIR10 from Phytozome) and Populus trichocarpa (Ptrichocarpa_444_v3.1 from Phytozome). All candidate gene models were then combined to form a single high-quality set of 34,010 gene models using EVidenceModeler v1.1.1 (https://github.com/EVidenceModeler/EVidenceModeler). The completeness of gene models was evaluated with BUSCO v5.3.2 (https://gitlab.com/ezlab/busco). The male gene models were transferred to the female genome assembly using GeMoMa.


### Analysis of synteny and WGD 
Syntelogs between homologous Nepenthes chromosomes were identified using JCVI v1.2.7 (https://github.com/tanghaibao/jcvi) with the MCscan pipeline. The identification of syntelogs between species was performed using SynMap2 (https://genomevolution.org/wiki/ index.php/SynMap2), which internally uses LAST for sequence alignments104
, and then fractionation bias was analysed with FractBias26 .
The reproducible links are as follows: Vitis versus Nepenthes (https:// genomevolution.org/r/1myic) and Vitis versus Coffea (https://genomevolution.org/r/1myu9). Synonymous divergence of paralogous pairs was obtained using WGDdetector v1.1 (ref. 105).




### Species tree inference 
A total of 1,614 single-copy genes conserved in land plants were searched in the genomes and transcriptomes from the 20 species using BUSCO with the Embryophyta dataset in OrthoDB v10 (embryophyta_odb10).
All genes marked as single-copy (S) or fragmented (F) were extracted, while those marked as duplicated (D) or missing (M) were treated as missing data (Supplementary Fig. 29). In-frame codon alignments were created by aligning translated protein sequences with MAFFT v7.475 (ref. 110), trimming by ClipKIT v1.3.0 (https://github.com/JLSteenwyk/ ClipKIT) and back-translation by CDSKIT v0.10.2 (https://github.com/ kfuku52/cdskit). For each single-copy gene, nucleotide and protein ML trees were generated using IQ-TREE v2.2.0.3 (https://github.com/iqtree/ iqtree2) with the GTR+R4 model and the LG+R4 model, respectively. The collection of 1,614 single-copy gene trees was subjected to the coalescence-based species tree inference with ASTRAL v.5.7.3 (https:// github.com/smirarab/ASTRAL). In addition, concatenated alignments were generated with catfasta2phyml v2018-09-28 (https://github.com/ nylander/catfasta2phyml) and used as input to IQ-TREE for nucleotide and protein ML tree inference with the above substitution models. Amborella trichopoda was used as the outgroup for rooting.


### Divergence time estimation 
Divergence time estimation was performed with, as input, the ML species tree and the concatenated codon alignment of single-copy genes. Fossil constraints used in previous studies111,112
were introduced with NWKIT v0.11.2 (https://github.com/kfuku52/nwkit). Species divergence was estimated with MCMCTREE in the PAML package v4.9 (https://github.com/abacus-gene/paml). Priors and parameters were chosen as described in a tutorial (http://abacus.gene.ucl.ac.uk/ software/paml.html). Branch lengths and substitution model parameters were pre-estimated using BASEML with a global clock using the GTR+G model.


### Comparative genomic analysis
Gene family clustering was performed using Orthofinder (option: -M msa) [53] based on the protein sequences of 14 species. Common single-copy genes were used to construct a maximum likelihood phylogenetic tree using Randomized Axelerated Maximum Likelihood (RAxML) software (model: PROTGAMMAWAG) [54]. The divergence times of the selected species were estimated using the MCMCtree subroutine of Phylogenetic Analysis by Maximum Likelihood (PAML; option: nsample: 3000000, burn: 8000000, seqtype: 0, model: 4) [55]. The Computational Analysis of gene Family Evolution (CAFE) was used to predict the contraction and expansion of gene families. MCScanX (option: -a -e 1e−5 -s) was used to analyze the genome collinearity. The ratio of the number of nonsynonymous substitutions per nonsynonymous site/Ks(Ka/Ks) values of the collinear gene pairs were calculated using the yn00 module in PAML.



